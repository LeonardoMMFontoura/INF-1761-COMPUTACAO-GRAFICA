<!DOCTYPE html>
<html>
  <meta charset="UTF-8">
  <body onload="main()">
    <canvas id = "myCanvas" width = "640" height = "480" style = "border:1px solid #000000;">
    </canvas>
    <p id="message"></p>
    <script id = "vShaderSrc" type = "nojs">#version 300 es
      in vec3 vPosition;
      in vec3 vNormal;
      
      uniform mat4 viewMatrix;
      uniform mat4 normalMatrix;
      uniform mat4 projectionMatrix;
      
      uniform vec4 objColor;
      uniform vec4 lightPosition;
      
      out vec4 vColor;
      void main(void){
        vec4 vPosEye = viewMatrix * vec4(vPosition,1.0);
        vec4 lightPosEye = viewMatrix * lightPosition;
        vec3 toLight = normalize(vec3(lightPosEye) - vec3(vPosEye));
        //vec3 normal = vec3(normalMatrix * vec4(vNormal,0.0));
        //float ndotl = max(0.1, dot(normal,toLight));
        //vColor = ndotl*objColor;
        gl_Position = projectionMatrix * vPosEye; 
        //passa para as coordenadas da camera 
        vec4 vtx = viewMatrix * vec4(vPosition,1.0);


        //vec4 vtx = viewMatrix*vec4(vPosition,1.0);
        
        vec3 light = vec3(lightPosition);
        vec3 tolight = normalize(light-vec3(vtx));
        vec3 normal = normalize(vec3(normalMatrix*vec4(vNormal,0.0)));
        float ndotl = max(0.0, dot(normal,tolight));
        vColor += ndotl*objColor*vec4(0.8,0.8,0.8,1.0);

        vec3 rLigth = reflect(-toLight,normal);
        rLigth = normalize(rLigth);
        vec3 toEye = -normalize(vec3(vtx));
        float rdote = max(0.,dot(rLigth,toEye));
        rdote = pow(rdote,60.0); 
        vColor += rdote*vec4(0.,0.7,0.7,1.0)*vec4(0.8,0.8,0.8,1.0);
        
        
        vColor[3] = 1.0;
        gl_Position = projectionMatrix * vtx;
    }
      
    </script>
    <script id = "fShaderSrc" type = "nojs">#version 300 es
      precision mediump float;
      in vec4  vColor;
      out vec4 fColor;
      void main(void){
	      fColor = vColor;
      }
    </script>
    <script src = "gl-matrix-min.js"></script>
    <script src = "myUtils.js"></script>
    <script src = "mymain.js"></script>
  </body>
</html>



